"use strict";
$(window).on("load", function () {
	setTimeout(function () {
		$(".page-loader").fadeOut()
	}, 500)
}), $(window).on("scroll", function () {
	$(window).scrollTop() >= 20 ? $(".header").addClass("header--scrolled") : $(".header").removeClass("header--scrolled")
}), $(document).ready(function () {
	if ($(".clock")[0]) {
		var a = new Date;
		a.setDate(a.getDate()), setInterval(function () {
			var a = (new Date).getSeconds();
			$(".time__sec").html((a < 10 ? "0" : "") + a)
		}, 1e3), setInterval(function () {
			var a = (new Date).getMinutes();
			$(".time__min").html((a < 10 ? "0" : "") + a)
		}, 1e3), setInterval(function () {
			var a = (new Date).getHours();
			$(".time__hours").html((a < 10 ? "0" : "") + a)
		}, 1e3)
	}
	$("body").on("click", ".themes__item", function (a) {
		a.preventDefault(), $(".themes__item").removeClass("active"), $(this).addClass("active");
		var b = $(this).data("sa-value");
		$("body").attr("data-sa-theme", b)
	}), $("body").on("focus", ".search__text", function () {
		$(this).closest(".search").addClass("search--focus")
	}), $("body").on("blur", ".search__text", function () {
		$(this), $(this).closest(".search").removeClass("search--focus")
	}), $("body").on("click", ".navigation__sub > a", function (a) {
		a.preventDefault(), $(this).parent().toggleClass("navigation__sub--toggled"), $(this).next("ul").slideToggle(250)
	}), $(".form-group--float")[0] && ($(".form-group--float").each(function () {
		0 == !$(this).find(".form-control").val().length && $(this).find(".form-control").addClass("form-control--active")
	}), $("body").on("blur", ".form-group--float .form-control", function () {
		0 == $(this).val().length ? $(this).removeClass("form-control--active") : $(this).addClass("form-control--active")
	})), $("body").on("click", ".dropdown-menu--active", function (a) {
		a.stopPropagation()
	})
}), $("#dropzone-upload")[0] && (Dropzone.autoDiscover = !1), $(document).ready(function () {
	if ($("#data-table")[0]) {
		$("#data-table").DataTable({
			autoWidth: !1,
			responsive: !0,
			lengthMenu: [
				[30, 50, 70, 90, -1],
				["30 Rows", "50 Rows", "70 Rows", "90 Rows", "Everything"]
			],
			language: {
				searchPlaceholder: "Search for records..."
			},
			dom: "Blfrtip",
			buttons: [{
				extend: "excelHtml5",
				title: "Export Data"
			}, {
				extend: "csvHtml5",
				title: "Export Data"
			}, {
				extend: "print",
				title: "Material Admin"
			}],
			initComplete: function (a, b) {
				$(this).closest(".dataTables_wrapper").prepend('<div class="dataTables_buttons hidden-sm-down actions"><span class="actions__item zmdi zmdi-print" data-table-action="print" /><span class="actions__item zmdi zmdi-fullscreen" data-table-action="fullscreen" /><div class="dropdown actions__item"><i data-toggle="dropdown" class="zmdi zmdi-download" /><ul class="dropdown-menu dropdown-menu-right"><a href="" class="dropdown-item" data-table-action="excel">Excel (.xlsx)</a><a href="" class="dropdown-item" data-table-action="csv">CSV (.csv)</a></ul></div></div>')
			}
		}), $("body").on("click", "[data-table-action]", function (a) {
			a.preventDefault();
			var b = $(this).data("table-action");
			if ("excel" === b && $(this).closest(".dataTables_wrapper").find(".buttons-excel").trigger("click"), "csv" === b && $(this).closest(".dataTables_wrapper").find(".buttons-csv").trigger("click"), "print" === b && $(this).closest(".dataTables_wrapper").find(".buttons-print").trigger("click"), "fullscreen" === b) {
				var c = $(this).closest(".card");
				c.hasClass("card--fullscreen") ? (c.removeClass("card--fullscreen"), $("body").removeClass("data-table-toggled")) : (c.addClass("card--fullscreen"), $("body").addClass("data-table-toggled"))
			}
		})
	}
	if ($(".textarea-autosize")[0] && autosize($(".textarea-autosize")), $("input-mask")[0] && $(".input-mask").mask(), $("select.select2")[0]) {
		var a = $(".select2-parent")[0] ? $(".select2-parent") : $("body");
		$("select.select2").select2({
			dropdownAutoWidth: !0,
			width: "100%",
			dropdownParent: a
		})
	}
	if ($("#dropzone-upload")[0] && $("#dropzone-upload").dropzone({
			url: "/file/post",
			addRemoveLinks: !0
		}), $(".datetime-picker")[0] && $(".datetime-picker").flatpickr({
			enableTime: !0,
			nextArrow: '<i class="zmdi zmdi-long-arrow-right" />',
			prevArrow: '<i class="zmdi zmdi-long-arrow-left" />'
		}), $(".date-picker")[0] && $(".date-picker").flatpickr({
			enableTime: !1,
			nextArrow: '<i class="zmdi zmdi-long-arrow-right" />',
			prevArrow: '<i class="zmdi zmdi-long-arrow-left" />'
		}), $(".time-picker")[0] && $(".time-picker").flatpickr({
			noCalendar: !0,
			enableTime: !0
		}), $("#input-slider")[0]) {
		var b = document.getElementById("input-slider");
		noUiSlider.create(b, {
			start: [20],
			connect: "lower",
			range: {
				min: 0,
				max: 100
			}
		}), b.noUiSlider.on("update", function (a, b) {
			document.getElementById("input-slider-value").value = a[b]
		})
	}
	if ($("#input-slider-range")[0]) {
		var c = document.getElementById("input-slider-range"),
			d = document.getElementById("input-slider-range-value-1"),
			e = document.getElementById("input-slider-range-value-2"),
			f = [d, e];
		noUiSlider.create(c, {
			start: [20, 80],
			connect: !0,
			range: {
				min: 0,
				max: 100
			}
		}), c.noUiSlider.on("update", function (a, b) {
			f[b].value = a[b]
		})
	}
	if ($(".input-slider")[0])
		for (var g = document.getElementsByClassName("input-slider"), h = 0; h < g.length; h++) noUiSlider.create(g[h], {
			start: [20],
			connect: "lower",
			range: {
				min: 0,
				max: 100
			}
		});
	if ($(".color-picker")[0] && ($(".color-picker__value").colorpicker(), $("body").on("change", ".color-picker__value", function () {
			$(this).closest(".color-picker").find(".color-picker__preview").css("backgroundColor", $(this).val())
		})), $(".wysiwyg-editor")[0] && $(".wysiwyg-editor").trumbowyg({
			autogrow: !0
		}), $(".lightbox")[0] && $(".lightbox").lightGallery({
			enableTouch: !0
		}), $('[data-toggle="popover"]')[0] && $('[data-toggle="popover"]').popover(), $('[data-toggle="tooltip"]')[0] && $('[data-toggle="tooltip"]').tooltip(), $(".widget-calendar__body")[0]) {
		$(".widget-calendar__body").fullCalendar({
			contentHeight: "auto",
			theme: !1,
			buttonIcons: {
				prev: " zmdi zmdi-long-arrow-left",
				next: " zmdi zmdi-long-arrow-right"
			},
			header: {
				right: "next",
				center: "title, ",
				left: "prev"
			},
			defaultDate: j,
			editable: !0,
			events: []
		});
		var i = moment().format("YYYY"),
			j = moment().format("dddd, MMM D");
		$(".widget-calendar__year").html(i), $(".widget-calendar__day").html(j)
	}
	if ($(".notes__body")[0]) {
		var k;
		$(".notes__body").each(function (a, b) {
			k = $(this).prev().is(".notes__title") ? 4 : 6, $clamp(b, {
				clamp: k
			})
		})
	}
	$(".scrollbar-inner")[0] && $(".scrollbar-inner").scrollbar().scrollLock();
	var l = [{
			name: "node1",
			children: [{
				name: "node1_1",
				children: [{
					name: "node1_1_1"
				}, {
					name: "node1_1_2"
				}, {
					name: "node1_1_3"
				}]
			}, {
				name: "node1_2"
			}, {
				name: "node1_3"
			}]
		}, {
			name: "node2",
			children: [{
				name: "node2_1"
			}, {
				name: "node2_2"
			}, {
				name: "node2_3"
			}]
		}, {
			name: "node3",
			children: [{
				name: "node3_1"
			}, {
				name: "node3_2"
			}, {
				name: "node3_3"
			}]
		}],
		m = [{
			name: "node1",
			children: [{
				name: "node1_1"
			}, {
				name: "node1_2"
			}, {
				name: "node1_3"
			}]
		}, {
			name: "node2",
			children: [{
				name: "node2_1"
			}, {
				name: "node2_2"
			}, {
				name: "node2_3"
			}]
		}],
		n = [{
			label: "node1",
			children: [{
				name: '<a href="example1.html">node1_1</a>'
			}, {
				name: '<a href="example2.html">node1_2</a>'
			}, '<a href="example3.html">Example </a>']
		}];
	$(".treeview")[0] && $(".treeview").tree({
		data: l,
		closedIcon: $('<i class="zmdi zmdi-plus"></i>'),
		openedIcon: $('<i class="zmdi zmdi-minus"></i>')
	}), $(".treeview-expanded")[0] && $(".treeview-expanded").tree({
		data: m,
		autoOpen: !0,
		closedIcon: $('<i class="zmdi zmdi-plus"></i>'),
		openedIcon: $('<i class="zmdi zmdi-minus"></i>')
	}), $(".treeview-drag")[0] && $(".treeview-drag").tree({
		data: m,
		dragAndDrop: !0,
		autoOpen: !0,
		closedIcon: $('<i class="zmdi zmdi-plus"></i>'),
		openedIcon: $('<i class="zmdi zmdi-minus"></i>')
	}), $(".treeview-drag")[0] && $(".treeview-drag").tree({
		data: m,
		dragAndDrop: !0,
		autoOpen: !0,
		closedIcon: $('<i class="zmdi zmdi-plus"></i>'),
		openedIcon: $('<i class="zmdi zmdi-minus"></i>')
	}), $(".treeview-escape")[0] && $(".treeview-escape").tree({
		data: n,
		autoEscape: !1,
		autoOpen: !0,
		closedIcon: $('<i class="zmdi zmdi-plus"></i>'),
		openedIcon: $('<i class="zmdi zmdi-minus"></i>')
	}), $(".rating")[0] && $(".rating").each(function () {
		var a = $(this).data("rating");
		$(this).rateYo({
			rating: a,
			normalFill: "rgba(255,255,255,0.3)",
			ratedFill: "#ffc107"
		})
	}), $(".text-counter")[0] && $(".text-counter").each(function () {
		var a = $(this).data("min-length") || 0,
			b = $(this).data("max-length");
		$(this).textcounter({
			min: a,
			max: b,
			countDown: !0,
			inputErrorClass: "is-invalid",
			counterErrorClass: "text-orange"
		})
	})
}), $(document).ready(function () {
	function a(a) {
		a.requestFullscreen ? a.requestFullscreen() : a.mozRequestFullScreen ? a.mozRequestFullScreen() : a.webkitRequestFullscreen ? a.webkitRequestFullscreen() : a.msRequestFullscreen && a.msRequestFullscreen()
	}
	$("body").on("click", "[data-sa-action]", function (b) {
		b.preventDefault();
		var c = $(this),
			d = c.data("sa-action"),
			e = "";
		switch (d) {
			case "search-open":
				$(".search").addClass("search--toggled");
				break;
			case "search-close":
				$(".search").removeClass("search--toggled");
				break;
			case "aside-open":
				e = c.data("sa-target"), c.addClass("toggled"), $("body").addClass("aside-toggled"), $(e).addClass("toggled"), $(".content, .header").append('<div class="sa-backdrop" data-sa-action="aside-close" data-sa-target=' + e + " />");
				break;
			case "aside-close":
				e = c.data("sa-target"), $("body").removeClass("aside-toggled"), $('[data-sa-action="aside-open"], ' + e).removeClass("toggled"), $(".content, .header").find(".sa-backdrop").remove();
				break;
			case "fullscreen":
				a(document.documentElement);
				break;
			case "print":
				window.print();
				break;
			case "login-switch":
				e = c.data("ma-target"), $(".login__block").removeClass("active"), $(e).addClass("active");
				break;
			case "notifications-clear":
				b.stopPropagation();
				var f = $(".top-nav__notifications .listview__item"),
					g = f.length,
					h = 0;
				c.fadeOut(), f.each(function () {
					var a = $(this);
					setTimeout(function () {
						a.addClass("animated fadeOutRight")
					}, h += 150)
				}), setTimeout(function () {
					f.remove(), $(".top-nav__notifications").addClass("top-nav__notifications--cleared")
				}, 180 * g);
				break;
			case "toolbar-search-open":
				$(this).closest(".toolbar").find(".toolbar__search").fadeIn(200), $(this).closest(".toolbar").find(".toolbar__search input").focus();
				break;
			case "toolbar-search-close":
				$(this).closest(".toolbar").find(".toolbar__search input").val(""), $(this).closest(".toolbar").find(".toolbar__search").fadeOut(200)
		}
	})
});


// Custom JS


/*Dropdown Menu*/
$('.dropdown-new').click(function () {
$(this).attr('tabindex', 1).focus();
$(this).toggleClass('active');
$(this).find('.dropdown-menu-new').slideToggle(300);
});

$('.dropdown-new .dropdown-menu-new li').click(function () {
$(this).parents('.dropdown-new').find('span').text($(this).text());
$(this).parents('.dropdown-new').find('input').attr('value', $(this));
});
/*End Dropdown Menu*/

// Catagory To Sub Catagory

$('.sub-cat').hide();
$('.call-sub-cat li').click(function(){
	var cat = $(this).html();
	cat = cat.toLowerCase();
	if(cat == 'project'){
		$('.sub-cat').show();
	}
	else{
		$('.sub-cat').hide();
	}
})

if($('.projects').hasClass('project-files')){
$('.project-files').click(function (){
$(this).parent().find('.project-file-list').slideToggle(300);
	})
}

$('.browse-btn').click(function(){
	$('.logo-up').click();
})

$('.logo-up').change(function(){
    var names = [];
    for (var i = 0; i < $(this).get(0).files.length; ++i) {
        names.push($(this).get(0).files[i].name);
    }
    var inputField = $(this).attr('class');
    
    $('.'+inputField+'-name').val(names);
})

//Profile Image Upload
$('.img_upload').click(function(e){
	e.preventDefault();
	$('.pic-upload').click();
	$('.pic-upload').change(function () {
         var filePath=$(this).val(); 
         // alert(filePath);
     });
})


// Supplyer popover

$(function(){
	$('.contact-pop').click(function(e){
		e.preventDefault();
		$(this).parent().find('.sup-contact-info').fadeToggle();
	})
})

// Reset Search Field

$('.search__helper').click(function(){
	if (!($(this).parent().parent().hasClass('search--focus'))) {

		$('.search__text').val('');
		$(".search_table tbody tr").show();
    $(".contact-container").show();


	}
})

// Category Show hide
	$('.pro-sub-category').hide();

$('.pro-category li').click(function(){
	$('.pro-sub-category').show();
})

	$('.sup-sub-category').hide();

$('.sup-category li').click(function(){
	$('.sup-sub-category').show();
})



//Delete Alert	
$('.delete-message').click(function(){
                swal({
                    title: 'Are you sure?',
                    text: 'You will not be able to recover this imaginary file!',
                    type: 'warning',
                    showCancelButton: true,
                    buttonsStyling: false,
                    confirmButtonClass: 'btn btn-danger',
                    confirmButtonText: 'Yes, delete it!',
                    cancelButtonClass: 'btn btn-light',
                    background: 'rgba(0, 0, 0, 0.96)'
                }).then(function(){
                    swal({
                        title: 'Are you sure?',
                        text: 'You will not be able to recover this imaginary file!',
                        type: 'success',
                        buttonsStyling: false,
                        confirmButtonClass: 'btn btn-light',
                        background: 'rgba(0, 0, 0, 0.96)'
                    });
                });
            });

$('.contacts__item:before').click(function(){
                swal({
                    title: 'Are you sure?',
                    text: 'You will not be able to recover this imaginary file!',
                    type: 'warning',
                    showCancelButton: true,
                    buttonsStyling: false,
                    confirmButtonClass: 'btn btn-danger',
                    confirmButtonText: 'Yes, delete it!',
                    cancelButtonClass: 'btn btn-light',
                    background: 'rgba(0, 0, 0, 0.96)'
                }).then(function(){
                    swal({
                        title: 'Are you sure?',
                        text: 'You will not be able to recover this imaginary file!',
                        type: 'success',
                        buttonsStyling: false,
                        confirmButtonClass: 'btn btn-light',
                        background: 'rgba(0, 0, 0, 0.96)'
                    });
                });
            });

// Print Supplier info

$('.printInfo').click(function(){
	var printDoc = $(this).attr('data-target');
	var supplierName = $(printDoc+' h2.suppliers-name').html();
	$(printDoc).printThis({
		pageTitle: supplierName,
	});
})

// IP btn active
$('.ip-permissions .btn').click(function(){
	$('.ip-permissions .btn.active').removeClass('btn-dark active').addClass('btn-light');
	$(this).addClass('btn-dark active').removeClass('btn-light');
	if($('.active').hasClass('public')){
		$('.ip-restrict').slideUp();
	}
	else{
		$('.ip-restrict').slideDown();
	}
})

// Mail Info Hover
$('.mail-full-info').hide();

$(document).ready(function(){
    $('.sent-mail-info').click(function(event){
        event.stopPropagation();
         $(".mail-full-info").toggle();
    });
    $(".mail-full-info").on("click", function (event) {
        event.stopPropagation();
    });
});

$(document).on("click", function () {
    $(".mail-full-info").hide();
});


 // Make Modal Call in dropdown
$('.actions-open-mail .dropdown-menu').click(function(e) {
    e.stopPropagation();
    if ($(e.target).is('[data-toggle=modal]')) {
        $($(e.target).data('target')).modal()
    }
});

// Reply-Forward Message
function extractEmails (text)
{
    return text.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);
}

function subStrAfterChars(str, char, pos)
{
  if(pos=='b')
   return str.substring(str.indexOf(char) + 1);
  else if(pos=='a') 
   return str.substring(0, str.indexOf(char));
  else
  return str;  
}

var from = $('.mail_from').text();
var to = $('.mail_sent_to').text();
var subject = $('.sent_mail_sub').text();
subject = subStrAfterChars(subject,':','b');
var reply = extractEmails(from);
var resend_to = extractEmails(to);

$('.rep-action').click(function(){
	var header = $(this).attr('title');
	$('#modal-rep-for .modal-title').html(header);
	$('#reply_to').val(reply);
	$('#reply_subject').val(subject);
	$('#modal-rep-for .wysiwyg-editor').html('');
})

$('.forward-action').click(function(){
	var header = $(this).attr('title');
	$('#modal-rep-for .modal-title').html(header);
	var forward_text = '-----Forward From-----'+$('.mail-full-info').html()+$('.txt-messages').html();
	$('#modal-rep-for .wysiwyg-editor').append(forward_text);
	$('#reply_to').val("");
})

$('.close-resend-forward').click(function(){
	$('#modal-rep-for .wysiwyg-editor').html('');
	$('#modal-resend .wysiwyg-editor').html('');
})

$('.resend-action').click(function(){
	var header = $(this).attr('title');
	$('#modal-resend .modal-title').html(header);
	var forward_text = '<div class="resend_text">'+$('.txt-messages').html()+'</div>';
	$('#modal-resend .wysiwyg-editor').append(forward_text);
	$('#resend_to').val(resend_to);
	$('#resend_subject').val(subject);
})

// Multiple Suppliers Hover View

$('.suppliers.multi').hover(function(){
	$(this).parent().find('.supplier-list').addClass('view');
},
function(){
	$('.supplier-list').removeClass('view');
})

$('.supplier-list').hover(function(){
	$(this).addClass('view');
},
function(){
	$(this).removeClass('view');
})

// Mail actions

$(document).ready(function(){
	if($('.select-action').prop("checked") == true){

	}
})

$('.select-action').click(function(){
	var target = $(this).attr('data-target');
	if($(this).prop("checked") == true){
		$('.mail-action').hide();
		$(target).show();
	}
})

// Preview Image From Input file

function readURL(input) {

  if (input.files && input.files[0]) {
    var reader = new FileReader();

    reader.onload = function(e) {
      $('.new-contact__img').attr('src', e.target.result);
    }

    reader.readAsDataURL(input.files[0]);
  }
}

$(".pic-upload").change(function() {
  readURL(this);
});



var count = 2;
$('.new-contact-add').click(function(e){
	// e.preventDefault();
	$(this).parent().parent().parent().parent().append(`<div class="row contact-`+count+`"><div class="col-sm-12 mb-3">
                                            <h4 class="card-title">
                                              Add Contact `+count+`</h4>`+
                                            `<div class="con-add-remove-btn"><a class="btn btn-dark new-contact-remove" onClick="removeContactForm(this)" data-id=`+count+`
                                          >Remove Contact</a> </div> 
                                        </div><div class="col-sm-6">
                                            <div class="form-group">
                                                <label>Person Name</label>
                                                <input type="text" class="form-control" placeholder="Person Name" name="person_name[]">
                                                <i class="form-group__bar"></i>
                                            </div>
                                        </div>
                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label>Person Designation</label>
                                                <input type="text" class="form-control" placeholder="Designation" name="designation[]">
                                                <i class="form-group__bar"></i>
                                            </div>
                                        </div>
                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label>Phone</label>
                                                <input type="text" class="form-control" placeholder="Phone" name="phone[]">
                                                <i class="form-group__bar"></i>
                                            </div>
                                        </div>
                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label>Email</label>
                                                <input type="text" class="form-control" placeholder="Email" name="email[]">
                                                <i class="form-group__bar"></i>
                                            </div>
                                        </div>
                                        
                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label>Social Address</label>
                                                <input type="text" class="form-control" placeholder="Social Address" name="social_address[]">
                                                <i class="form-group__bar"></i>
                                            </div>
                                        </div>
                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label>Address</label>
                                                <input type="text" class="form-control" placeholder="Addreess" name="address[]">
                                                <i class="form-group__bar"></i>
                                            </div>
                                        </div></div>`);
	count++;
})


if($('.con-add-remove-btn .btn').hasClass('new-contact-remove')){
var lastData = $('.btn.new-contact-remove').last().attr('data-id');
count = ++lastData;
}
function removeContactForm(a){
	var currentRow = a.getAttribute('data-id');
	$('.contact-'+currentRow).remove();
	count--;
}